# Git flow

## Правила оформления коммитов

Коммиты именуются на русском языке.

В проекте используется [commitizen](http://commitizen.github.io/cz-cli/) — он позволяет автоматизировать форматирование имен коммитов. Запускается при вызове `git commit`.

Для именования коммитов выбрана спецификация [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/). Она позволяет автоматически повышать версии с помощью `lerna`. Важно корректно выбирать типы коммитов. Подробности ниже.

Коммиты имеют следующий шаблон:

```
тип(область изменения): краткое описание изменений

Подробное описание

BREAKING CHANGE:
Описание изменений, ломающих обратную совместимость
```

### Типы коммитов

Возможные типы:

- `fix` - исправление багов, опечаток
- `feat` - используется при добавлении новой функциональности
- `test` - все, что связано с тестированием
- `refactor` - рефакторинг кода
- `docs` - все, что касается документации
- `chore` - добавление/обновление/настройка инструментов и библиотек

Согласно спецификации [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/):

- `fix` - повышает `patch` у версии пакета, если не указаны `BREAKING CHANGE`
- `feat` - повышает `minor` у версии пакета, если не указаны `BREAKING CHANGE`
- если указаны `BREAKING CHANGE`, то независимо от типа коммита — повышается `major` у версии

### BREAKING CHANGE

Описание изменений, ломающих обратную совместимость.

Согласно спецификации [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/):
breaking change может произойти в коммитах любого типа.

Что относится к ломающим изменениям:

- удаление существующего свойства API компонента
- изменение в работе существующего свойства API

Пример: пропс `title` отвечал за рендер нативного тултипа через атрибут `title`, а теперь отвечает за вывод видимого текста внутри компонента

- удаление компонента
- отказ от поддержки браузера, который до этого поддерживался
- переименование API/пропсов компонента

Пример: переименование `autofocus` на `autoFocus`

- изменения в дизайне компонента

Пример: кнопка была по умолчанию синего цвета, а теперь стала белого

Что не относится к ломающим изменениям:

- рефакторинг компонента, т.е. внутренние изменения, не влияющие на API
- добавление нового API в существующий компонент (например, добавление новых пропсов)

### Область изменения (скоуп)

Позволяет коротко указать, в какой области репозитория произошло изменение.
Можно выбирать из небольшого предзаданного списка скоупов, но желательно выбирать `custom` и вводить свой.
Также можно выбрать `empty`, в этом случае скоуп не нужно будет указывать.

**Примеры `custom` скоупов:**

```
# имена пакетов
select
button
text
hooks

# разделы инфраструктуры
deps
build
storybook

# конкретные файлы
package.json
CODEOWNERS
```

### Краткое описание изменений

Коротко и понятно описываем действие, которое происходит в этом коммите.

**Стиль:**

```
действие (с маленькой буквы) + для какой сущности + (необязательно подробности)
```

**Например:**

```
feat(hooks): добавить хук useSelect
test(select): протестировать очистку
fix(modal): исправить позиционирование на экранах <500px
```

### Подробное описание (опционально)

Заполнение тела коммита опционально. Нужно в том случае, если описание решенной проблемы достаточно сложно и не может уместиться в строку заголовка.

## Правила оформления PR

## Как влить PR в master

В проекте принято вливать PR с помощью `git rebase` и `git merge --squash`. Обычный `git merge` не используется.

![git-flow-pic-1](static/git-flow/git-flow-pic-1.png)

### Что выбрать: rebase или squash?

- `rebase`: если коммиты в PR оформлены с использованием `commitizen` и по правилам [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/#summary), описания коммитов понятны и соответствуют сделанной в них работе
- `squash`: в ином случае
